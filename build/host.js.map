{"version":3,"sources":["webpack:///webpack/bootstrap 7722d916c378586046c7?048e*","webpack:///./embed/host/index.js","webpack:///./embed/actions.js?d20f","webpack:///./embed/host/frame.js","webpack:///./embed/host/oauth.js"],"names":[],"mappings":"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","file":"host.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 7722d916c378586046c7\n **/","import frame from './frame'\nimport { oauth } from './oauth'\nwindow.Ringcentral = window.Ringcentral || {}\nwindow.Ringcentral.widgets = {\n    oauth\n}\nwindow.addEventListener('message', function(e) {\n    var state = e.data\n    frame.width = state.size.width\n    frame.height = state.size.height\n    if (state.status.unmount) {\n        frame.parentNode.removeChild(frame)\n    }\n    if (state.status.ready) {\n        frame.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\n        frame.style['transition'] = 'height .150s cubic-bezier(0.4, 0.0, 0.2, 1)'\n    }\n})\n// Ringcentral.on()\n// Ringcentral.oauth()\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/index.js\n **/","export default {\n    HOST_DIALPAD_NUMBER: 100,\n    GUEST_INIT: 200,\n    GUEST_PHONE_RESIZE: 201,\n    GUEST_DIALPAD_NUMBER: 202,\n    GUEST_PHONE_UNMOUNT: 203,\n    GUEST_PHONE_READY: 204\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/actions.js\n **/","import actions from '../actions'\n\nconst TAG = document.querySelector('#rc-widgets-script').getAttribute('src')\nconst BASEURL = new URL(TAG).href\n// const PHONE_URL = DOMAIN + '/ringcentral-js-widget/build/widgets.js'\n// const LIB_URL = DOMAIN + '/ringcentral-js-widget/build/build.js'\n// const COMMON_STYLE_URL = [DOMAIN + '/ringcentral-js-widget/build/styles/main.css']\nconst TARGET_TAG = 'rc-phone'\nconst IFRAME_URL = BASEURL.substr(0, BASEURL.lastIndexOf('/')) + '/embed.html'\nconst useShadowDOM = false /* Always fallback to iframe for now */\nconst iframeReadyQueue = []\nvar frame\n\nvar iframeReady = false\nvar drag = false\n\n// var safeEval = function(script, target) {\n//     var tag = document.createElement('script')\n//     tag.text = script\n//     if (target) {\n//         target.appendChild(tag)\n//         // target.removeChild(tag)\n//     } else {\n//         document.body.appendChild(tag)\n//         document.body.removeChild(tag)\n//     }\n// }\n// var fetchAndEval = function(url, target) {\n//     return function() {\n//         return fetch(url)\n//                 .then(res => res.text())\n//                 .then(data => safeEval(data, target))\n//     }\n// }\n\n// var fetchAndEvalFramework = fetchAndEval(LIB_URL)\n// var fetchAndEvalWidget = fetchAndEval(PHONE_URL)\n\nvar createContainer = function() {\n    var target = document.querySelector(TARGET_TAG)\n    if (!target) return\n    var shadow = target.createShadowRoot()\n    var container = document.createElement('div')\n    shadow.appendChild(container)\n\n    COMMON_STYLE_URL.forEach(src => {\n        fetch(src)\n        .then(res => res.text())\n        .then(style => {\n            var tag = document.createElement('style')\n            tag.innerHTML = style\n            shadow.appendChild(tag)\n        })\n    })\n    appendWidget(container, shadow)\n\n    function appendStyle() {\n\n    }\n\n    function appendWidget(container, shadowRoot) {\n        var phone = w(TARGET_TAG, {\n            shadowRoot,\n            data: {\n                shadowRoot\n            }\n        })\n        phone.mount(container)\n    }\n    return container\n}\n\nvar createIframe = function() {\n    var target = document.querySelector(TARGET_TAG)\n    var options = getOptions(target)\n    var iframe = document.createElement('iframe')\n\n    iframe.width = parseInt(options.width) + 2 // border\n    iframe.height = options.height\n    iframe.style.border = 0\n    iframe.src = IFRAME_URL + '?' +\n                    `first-level=${options.firstLevel}&` +\n                    `width=${options.width}&` +\n                    `height=${options.height}&` +\n                    `key=${options.key}&` +\n                    `secret=${options.secret}&` +\n                    `sandbox=${options.sandbox != null}&` +\n                    `origin=${window.location.origin}`\n    iframe.setAttribute('name', 'rc-iframe')\n    if (options.dynamic != null) {\n        target.style.display = 'none'\n        iframe.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\n        clickToDial(target, iframe)\n    }\n    if (options.fixed != null) {\n        target.style.position = 'fixed'\n        target.style.top = 0\n        target.style.right = '5px'\n        clickToDial(target, iframe)\n        // iframe.style.background = '#1e89ed'\n        // iframe.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\n    }\n    \n    target.appendChild(iframe)\n    return iframe\n}\n\nvar getOptions = function(target) {\n    return {\n        firstLevel: target.getAttribute('first-level'),\n        width: target.getAttribute('width'),\n        height: target.getAttribute('height'),\n        dynamic: target.getAttribute('dynamic'),\n        fixed: target.getAttribute('fixed'),\n        key: target.getAttribute('key'),\n        secret: target.getAttribute('secret'),\n        sandbox: target.getAttribute('sandbox'),\n    }\n}\n\nvar clickToDial = function(target, iframe) {\n    [...document.querySelectorAll('[data-phone]')].forEach(ele => {\n        ele.style['text-decoration'] = 'underline black'\n        ele.style['cursor'] = 'pointer'\n        ele.addEventListener('click', e => {\n            // target.style.display = 'block'\n            // target.style.position = 'absolute'\n            // target.style.top = `${e.pageY + 3}px`\n            // target.style.left = `${e.pageX + 3}px`\n            iframe.contentWindow.postMessage({\n                type: actions.HOST_DIALPAD_NUMBER,\n                value: ele.getAttribute('data-phone')\n            }, IFRAME_URL)\n            e.stopPropagation()\n        })\n    })\n}\n\nwindow.addEventListener('message', function(e) {\n    if (e.data.type === 'init') {\n        iframeReady = true\n        iframeReadyQueue.forEach(action => action(e.source))\n        iframeReadyQueue.length = 0\n    }\n})\n\nif (document.body.createShadowRoot && useShadowDOM) {\n    // shadow dom is supported\n    // The order is important\n    fetchAndEvalWidget()\n    .then(fetchAndEvalFramework)\n    .then(createContainer)\n    .catch(e => console.error(e))\n} else {\n    // fallback to iframe\n    frame = createIframe()\n}\nexport default frame\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/frame.js\n **/","export function oauth(sdk) {\n    var redirectUri = window.location.origin + '/ringcentral-js-widget/demo/redirect.html'\n    window.open(\n        sdk.platform().authUrl({redirectUri}),\n        'rc-iframe-2',\n        'width=400, height=600'\n    )\n    return new Promise((resolve, reject) => {\n        window.addEventListener('message', function(e) {\n            if (e.data.type === 'oauth') {\n                var qs = sdk.platform().parseAuthRedirectUrl(e.data.value);\n                qs.redirectUri = redirectUri;\n                resolve(qs)\n            }\n        })\n    })\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/oauth.js\n **/"],"sourceRoot":""}