{"version":3,"sources":["webpack:///webpack/bootstrap d537288a59716d2fbab0?d148*","webpack:///./embed/host/index.js","webpack:///./embed/actions.js?d20f","webpack:///./embed/host/frame.js","webpack:///./embed/host/oauth.js"],"names":[],"mappings":"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","file":"host.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d537288a59716d2fbab0\n **/","import frame from './frame'\r\nimport { oauth } from './oauth'\r\nwindow.Ringcentral = window.Ringcentral || {}\r\nwindow.Ringcentral.widgets = {\r\n    oauth\r\n}\r\nwindow.addEventListener('message', function(e) {\r\n    var state = e.data\r\n    frame.width = state.size.width\r\n    frame.height = state.size.height\r\n    if (state.status.unmount) {\r\n        frame.parentNode.removeChild(frame)\r\n    }\r\n    if (state.status.ready) {\r\n        frame.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\r\n    }\r\n})\r\n// Ringcentral.on()\r\n// Ringcentral.oauth()\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/index.js\n **/","export default {\r\n    HOST_DIALPAD_NUMBER: 100,\r\n    GUEST_INIT: 200,\r\n    GUEST_PHONE_RESIZE: 201,\r\n    GUEST_DIALPAD_NUMBER: 202,\r\n    GUEST_PHONE_UNMOUNT: 203,\r\n    GUEST_PHONE_READY: 204\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/actions.js\n **/","import actions from '../actions'\r\n\r\nconst TAG = document.querySelector('#rc-widgets-script').getAttribute('src')\r\nconst BASEURL = new URL(TAG).href\r\n// const PHONE_URL = DOMAIN + '/ringcentral-js-widget/build/widgets.js'\r\n// const LIB_URL = DOMAIN + '/ringcentral-js-widget/build/build.js'\r\n// const COMMON_STYLE_URL = [DOMAIN + '/ringcentral-js-widget/build/styles/main.css']\r\nconst TARGET_TAG = 'rc-phone'\r\nconst IFRAME_URL = BASEURL.substr(0, BASEURL.lastIndexOf('/')) + '/embed.html'\r\nconst useShadowDOM = false /* Always fallback to iframe for now */\r\nconst iframeReadyQueue = []\r\nvar frame\r\n\r\nvar iframeReady = false\r\nvar drag = false\r\n\r\n// var safeEval = function(script, target) {\r\n//     var tag = document.createElement('script')\r\n//     tag.text = script\r\n//     if (target) {\r\n//         target.appendChild(tag)\r\n//         // target.removeChild(tag)\r\n//     } else {\r\n//         document.body.appendChild(tag)\r\n//         document.body.removeChild(tag)\r\n//     }\r\n// }\r\n// var fetchAndEval = function(url, target) {\r\n//     return function() {\r\n//         return fetch(url)\r\n//                 .then(res => res.text())\r\n//                 .then(data => safeEval(data, target))\r\n//     }\r\n// }\r\n\r\n// var fetchAndEvalFramework = fetchAndEval(LIB_URL)\r\n// var fetchAndEvalWidget = fetchAndEval(PHONE_URL)\r\n\r\nvar createContainer = function() {\r\n    var target = document.querySelector(TARGET_TAG)\r\n    if (!target) return\r\n    var shadow = target.createShadowRoot()\r\n    var container = document.createElement('div')\r\n    shadow.appendChild(container)\r\n\r\n    COMMON_STYLE_URL.forEach(src => {\r\n        fetch(src)\r\n        .then(res => res.text())\r\n        .then(style => {\r\n            var tag = document.createElement('style')\r\n            tag.innerHTML = style\r\n            shadow.appendChild(tag)\r\n        })\r\n    })\r\n    appendWidget(container, shadow)\r\n\r\n    function appendStyle() {\r\n\r\n    }\r\n\r\n    function appendWidget(container, shadowRoot) {\r\n        var phone = w(TARGET_TAG, {\r\n            shadowRoot,\r\n            data: {\r\n                shadowRoot\r\n            }\r\n        })\r\n        phone.mount(container)\r\n    }\r\n    return container\r\n}\r\n\r\nvar createIframe = function() {\r\n    var target = document.querySelector(TARGET_TAG)\r\n    var options = getOptions(target)\r\n    var iframe = document.createElement('iframe')\r\n\r\n    iframe.width = parseInt(options.width) + 2 // border\r\n    iframe.height = options.height\r\n    iframe.style.border = 0\r\n    iframe.src = IFRAME_URL + '?' +\r\n                    `first-level=${options.firstLevel}&` +\r\n                    `width=${options.width}&` +\r\n                    `height=${options.height}&` +\r\n                    `key=${options.key}&` +\r\n                    `secret=${options.secret}&` +\r\n                    `origin=${window.location.origin}`\r\n    iframe.setAttribute('name', 'rc-iframe')\r\n    if (options.dynamic != null) {\r\n        target.style.display = 'none'\r\n        iframe.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\r\n        clickToDial(target, iframe)\r\n    }\r\n    if (options.fixed != null) {\r\n        target.style.position = 'fixed'\r\n        target.style.top = 0\r\n        target.style.right = '5px'\r\n        clickToDial(target, iframe)\r\n        // iframe.style.background = '#1e89ed'\r\n        // iframe.style['box-shadow'] = '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'\r\n    }\r\n    target.appendChild(iframe)\r\n    return iframe\r\n}\r\n\r\nvar getOptions = function(target) {\r\n    return {\r\n        firstLevel: target.getAttribute('first-level'),\r\n        width: target.getAttribute('width'),\r\n        height: target.getAttribute('height'),\r\n        dynamic: target.getAttribute('dynamic'),\r\n        fixed: target.getAttribute('fixed'),\r\n        key: target.getAttribute('key'),\r\n        secret: target.getAttribute('secret'),\r\n    }\r\n}\r\n\r\nvar clickToDial = function(target, iframe) {\r\n    [...document.querySelectorAll('[data-phone]')].forEach(ele => {\r\n        ele.style['text-decoration'] = 'underline black'\r\n        ele.style['cursor'] = 'pointer'\r\n        ele.addEventListener('click', e => {\r\n            // target.style.display = 'block'\r\n            // target.style.position = 'absolute'\r\n            // target.style.top = `${e.pageY + 3}px`\r\n            // target.style.left = `${e.pageX + 3}px`\r\n            iframe.contentWindow.postMessage({\r\n                type: actions.HOST_DIALPAD_NUMBER,\r\n                value: ele.getAttribute('data-phone')\r\n            }, IFRAME_URL)\r\n            e.stopPropagation()\r\n        })\r\n    })\r\n}\r\n\r\nwindow.addEventListener('message', function(e) {\r\n    if (e.data.type === 'init') {\r\n        iframeReady = true\r\n        iframeReadyQueue.forEach(action => action(e.source))\r\n        iframeReadyQueue.length = 0\r\n    }\r\n})\r\n\r\nif (document.body.createShadowRoot && useShadowDOM) {\r\n    // shadow dom is supported\r\n    // The order is important\r\n    fetchAndEvalWidget()\r\n    .then(fetchAndEvalFramework)\r\n    .then(createContainer)\r\n    .catch(e => console.error(e))\r\n} else {\r\n    // fallback to iframe\r\n    frame = createIframe()\r\n}\r\nexport default frame\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/frame.js\n **/","export function oauth(sdk) {\r\n    var redirectUri = window.location.origin + '/ringcentral-js-widget/demo/redirect.html'\r\n    window.open(\r\n        sdk.platform().authUrl({redirectUri}),\r\n        'rc-iframe-2',\r\n        'width=400, height=600'\r\n    )\r\n    return new Promise((resolve, reject) => {\r\n        window.addEventListener('message', function(e) {\r\n            if (e.data.type === 'oauth') {\r\n                var qs = sdk.platform().parseAuthRedirectUrl(e.data.value);\r\n                qs.redirectUri = redirectUri;\r\n                resolve(qs)\r\n            }\r\n        })\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./embed/host/oauth.js\n **/"],"sourceRoot":""}